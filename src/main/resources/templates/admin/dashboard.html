<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Citas M√©dicas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<!-- Navbar superior -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">Admin Dashboard</a>
        <div class="d-flex">
            <span class="navbar-text text-white me-3">
                Bienvenido, <span th:text="${admin.name}">Admin</span>
            </span>
            <a th:href="@{/citasmedicas/admin/login}" class="btn btn-danger">Cerrar sesi√≥n</a>
        </div>
    </div>
</nav>

<div class="container-fluid">
    <div class="row">
        <!-- Men√∫ lateral -->
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
            <div class="position-sticky pt-3">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" href="#doctores" data-bs-toggle="tab">üìã Doctores</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#pacientes" data-bs-toggle="tab">üë• Pacientes</a>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- Contenido principal -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 py-4">

            <!-- Mensajes de √©xito -->
            <div th:if="${param.success}" class="alert alert-success alert-dismissible fade show" role="alert">
                <span th:text="${param.success}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <div class="tab-content">

                <!-- Secci√≥n Doctores -->
                <div class="tab-pane fade show active" id="doctores">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2>Gesti√≥n de Doctores</h2>
                        <a th:href="@{/citasmedicas/admin/doctores/registrar}" class="btn btn-primary">‚ûï Agregar Doctor</a>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-striped table-bordered">
                            <thead class="table-dark">
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Especialidad</th>
                                <th>Acciones</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="doctor : ${doctores}">
                                <td th:text="${doctor.id}"></td>
                                <td th:text="${doctor.name}"></td>
                                <td th:text="${doctor.email}"></td>
                                <td th:text="${doctor.especialidad}"></td>
                                <td>
                                    <a th:href="@{/citasmedicas/admin/doctores/editar/{id}(id=${doctor.id})}"
                                       class="btn btn-sm btn-warning">‚úèÔ∏è Editar</a>
                                    <button class="btn btn-sm btn-danger"
                                            data-bs-toggle="modal"
                                            data-bs-target="#modalEliminarDoctor"
                                            th:data-doctor-id="${doctor.id}"
                                            th:data-doctor-name="${doctor.name}">
                                        üóëÔ∏è Eliminar
                                    </button>
                                </td>
                            </tr>
                            <tr th:if="${doctores.empty}">
                                <td colspan="5" class="text-center text-muted">No hay doctores registrados</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Secci√≥n Pacientes -->
                <div class="tab-pane fade" id="pacientes">
                    <h2 class="mb-3">Gesti√ìn de Pacientes</h2>

                    <div class="table-responsive">
                        <table class="table table-striped table-bordered">
                            <thead class="table-dark">
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Acciones</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="paciente : ${pacientes}">
                                <td th:text="${paciente.id}"></td>
                                <td th:text="${paciente.name}"></td>
                                <td th:text="${paciente.email}"></td>
                                <td>
                                    <a th:href="@{/citasmedicas/admin/pacientes/editar/{id}(id=${paciente.id})}"
                                       class="btn btn-sm btn-warning">‚úèÔ∏è Editar</a>
                                    <button class="btn btn-sm btn-danger"
                                            data-bs-toggle="modal"
                                            data-bs-target="#modalEliminarPaciente"
                                            th:data-paciente-id="${paciente.id}"
                                            th:data-paciente-name="${paciente.name}">
                                        üóëÔ∏è Eliminar
                                    </button>
                                </td>
                            </tr>
                            <tr th:if="${pacientes.empty}">
                                <td colspan="4" class="text-center text-muted">No hay pacientes registrados</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>

        </main>
    </div>
</div>

<!-- Modal Eliminar Doctor -->
<div class="modal fade" id="modalEliminarDoctor" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirmar Eliminaci√≥n</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>¬øEst√°s seguro de que deseas eliminar al doctor <strong id="doctorNombreEliminar"></strong>?</p>
                <p class="text-danger"><small>Esta acci√≥n no se puede deshacer.</small></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <form id="formEliminarDoctor" method="post">
                    <button type="submit" class="btn btn-danger">S√≠, Eliminar</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Modal Eliminar Paciente -->
<div class="modal fade" id="modalEliminarPaciente" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirmar Eliminaci√≥n</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>¬øEst√°s seguro de que deseas eliminar al paciente <strong id="pacienteNombreEliminar"></strong>?</p>
                <p class="text-danger"><small>Esta acci√≥n no se puede deshacer.</small></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <form id="formEliminarPaciente" method="post">
                    <button type="submit" class="btn btn-danger">S√≠, Eliminar</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Configurar modal para eliminar doctor
    document.getElementById('modalEliminarDoctor').addEventListener('show.bs.modal', function (event) {
        const button = event.relatedTarget;
        const doctorId = button.getAttribute('data-doctor-id');
        const doctorName = button.getAttribute('data-doctor-name');

        document.getElementById('doctorNombreEliminar').textContent = doctorName;
        document.getElementById('formEliminarDoctor').action = '/citasmedicas/admin/doctores/eliminar/' + doctorId;
    });

    // Configurar modal para eliminar paciente
    document.getElementById('modalEliminarPaciente').addEventListener('show.bs.modal', function (event) {
        const button = event.relatedTarget;
        const pacienteId = button.getAttribute('data-paciente-id');
        const pacienteName = button.getAttribute('data-paciente-name');

        document.getElementById('pacienteNombreEliminar').textContent = pacienteName;
        document.getElementById('formEliminarPaciente').action = '/citasmedicas/admin/pacientes/eliminar/' + pacienteId;
    });
</script>
</body>
</html>
